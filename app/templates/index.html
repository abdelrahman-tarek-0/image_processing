<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Image Algorithms</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            text-align: center;
        }
        .button-container {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 10px;
            margin: 20px auto;
            max-width: 600px;
        }
        button {
            padding: 15px 25px; 
            margin-bottom: 10px; 
            font-size: 16px;
            flex: 1 1 calc(25% - 10px); 
            box-sizing: border-box;
            border-radius: 5px; 
            border: 1px solid #ccc; 
            background-color: #f9f9f9; 
            cursor: pointer;
        }

        button:hover {
        background-color: #e0e0e0; 
        }

        button.active {
            background-color: red;
            color: white;
        }
        img {
            margin-top: 20px;
            max-width: 80%;
            border: 1px solid #ccc;
        }


        .processed-images {
        display: flex;
        justify-content: center;
        gap: 20px;
        flex-wrap: wrap;
    }
        .processed-images img {
            max-width: 300px;
            border: 1px solid #ccc;
        }
    </style>

    <script>
        // Function to highlight the button and store the state
        function highlightButton(button, buttonValue) {
            // Remove "active" class from all buttons
            const buttons = document.querySelectorAll('.button-container button');
            buttons.forEach(btn => btn.classList.remove('active'));

            // Add "active" class to the clicked button
            button.classList.add('active');

            // Store the active button value in localStorage
            localStorage.setItem('activeButton', buttonValue);
        }

        // Function to restore the button state on page load
        function restoreActiveButton() {
            const activeButtonValue = localStorage.getItem('activeButton');
            if (activeButtonValue) {
                const button = document.querySelector(`button[value="${activeButtonValue}"]`);
                if (button) {
                    button.classList.add('active');
                }
            }
        }

        // Run the restore function on page load
        document.addEventListener('DOMContentLoaded', restoreActiveButton);
    </script>
</head>
<body>
    <h1>Upload and Process Image</h1>

    <!-- Upload Form -->
    <form method="POST" enctype="multipart/form-data">
        <label for="file">Upload an image:</label>
        <input type="file" name="file" id="file">
        <button type="submit">Upload</button>
    </form>

    {% if uploaded_filename %}
        <h2>Uploaded Image:</h2>
        <img src="{{ url_for('uploaded_image', filename=uploaded_filename) }}" alt="Uploaded Image" style="max-width: 300px;">
        
        <!-- Processing Buttons -->
        <h1>Image Processing Algorithms</h1>
        <div class="button-container">
            <form action="/" method="POST">
                <input type="hidden" name="uploaded_image_filename" value="{{ uploaded_filename }}">
                <button type="submit" name="button_id" value="button1" onclick="highlightButton(this, 'button1')">Halftoning</button>
                <button type="submit" name="button_id" value="button2" onclick="highlightButton(this, 'button2')">Histogram</button>
                <button type="submit" name="button_id" value="button3" onclick="highlightButton(this, 'button3')">Sobel</button>
                <button type="submit" name="button_id" value="button4" onclick="highlightButton(this, 'button4')">Prewitt</button>
                <button type="submit" name="button_id" value="button5" onclick="highlightButton(this, 'button5')">Kirsch</button>
                <button type="submit" name="button_id" value="button6" onclick="highlightButton(this, 'button6')">Homogeneity</button>
                <button type="submit" name="button_id" value="button7" onclick="highlightButton(this, 'button7')">Difference</button>
                <button type="submit" name="button_id" value="button8" onclick="highlightButton(this, 'button8')">Difference Gaussian</button>
                <button type="submit" name="button_id" value="button9" onclick="highlightButton(this, 'button9')">Contrast</button>
                <button type="submit" name="button_id" value="button10" onclick="highlightButton(this, 'button10')">Variance</button>
                <button type="submit" name="button_id" value="button11" onclick="highlightButton(this, 'button11')">Range</button>
                <button type="submit" name="button_id" value="button12" onclick="highlightButton(this, 'button12')">High Pass</button>
                <button type="submit" name="button_id" value="button13" onclick="highlightButton(this, 'button13')">Low Pass</button>
                <button type="submit" name="button_id" value="button14" onclick="highlightButton(this, 'button14')">Median Filter</button>
                <button type="submit" name="button_id" value="button15" onclick="highlightButton(this, 'button15')">Add</button>
                <button type="submit" name="button_id" value="button16" onclick="highlightButton(this, 'button16')">Subtract Filter</button>
                <button type="submit" name="button_id" value="button17" onclick="highlightButton(this, 'button17')">Invert</button>
                <button type="submit" name="button_id" value="button18" onclick="highlightButton(this, 'button18')">Manual Segmentation</button>
                <button type="submit" name="button_id" value="button19" onclick="highlightButton(this, 'button19')">Histogram Peak</button>
                <button type="submit" name="button_id" value="button20" onclick="highlightButton(this, 'button20')">Histogram Valley</button>
                <button type="submit" name="button_id" value="button21" onclick="highlightButton(this, 'button21')">Adaptive Histogram</button>
            </form>
        </div>
    {% endif %}

    <!-- Show the processed image -->
    <!-- {% if processed_image_filename %}
        <h2>Processed Image:</h2>
        <img src="{{ url_for('processed_image', filename=processed_image_filename) }}" alt="Processed Image" style="max-width: 300px;">
    {% endif %} -->

    {% if processed_image_filenames %}
    <h2>Processed Image(s):</h2>
    <div class="processed-images">
        {% for filename in processed_image_filenames %}
            <img src="{{ url_for('processed_image', filename=filename) }}" alt="Processed Image" style="max-width: 300px; margin: 10px;">
        {% endfor %}
    </div>
    {% endif %}
</body>
</html>
